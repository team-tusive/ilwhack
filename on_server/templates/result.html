<html>
   <head>
      <link rel="stylesheet" type="text/css" href="/css/stylesheet.css">
      <script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
      <script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=geometry&sensor=false"></script>
      <script src="http://www.google.com/jsapi?key=ABQIAAAAvpzZIJ6aE1PP3WOYtmjZ3BTq7sWfP_v_VCssE0RxAm52ohNf_RRHW8r2VF3Z1ijKTltH6UdcIQaiAw" type="text/javascript"></script>
      <script type="text/javascript">
         var directionDisplay;
         var directionsRenderer;
         var directionsService = new google.maps.DirectionsService();
         var map;

         function drawMap() {

            var start = new google.maps.LatLng("55.941125", "-3.205261");
            var myOptions = {
                              zoom:7,
                              mapTypeId: google.maps.MapTypeId.ROADMAP,
                              center: start,
                              mapTypeControl: false
                             }
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
         }

         function getRendererOptions() {

            var _colour = '#00458E';
            var _strokeWeight = 4;
            var _strokeOpacity = 1.0;
            var _suppressMarkers = false;
            var polylineOptions ={ strokeColor: _colour, strokeWeight: _strokeWeight, strokeOpacity: _strokeOpacity  };
            var rendererOptions = {draggable: false, suppressMarkers: _suppressMarkers, polylineOptions: polylineOptions};
            return rendererOptions;
         }

         function renderDirections(result, rendererOptions, routeToDisplay) {

            var rideCoordinates = google.maps.geometry.encoding.decodePath(result.routes[routeToDisplay].overview_polyline.points);
            var ridePath = new google.maps.Polyline({
                                                      map:            map,
                                                      path:           rideCoordinates,
                                                      strokeColor:    "#00458E",
                                                      strokeOpacity:  1.0,
                                                      strokeWeight:   4
                                                      });

            var ne = new google.maps.LatLng(result.routes[routeToDisplay].bounds.northeast.lat, result.routes[routeToDisplay].bounds.northeast.lng);
            var sw = new google.maps.LatLng(result.routes[routeToDisplay].bounds.southwest.lat, result.routes[routeToDisplay].bounds.southwest.lng);
            map.fitBounds(new google.maps.LatLngBounds(sw, ne));
         }


         function drawDirections(result) {

            var rendererOptions = getRendererOptions();
            for (var i = 0; i < result.routes.length; i++) {
               renderDirections(result, rendererOptions, i);
            }
         }
      </script>
   </head>
   <body>
      <div id="map_canvas" style="width: 640px; height: 300px"></div>
      <script type="text/javascript">
         drawMap();
         result = {% autoescape off %}{{ result }}{% endautoescape %}
         drawDirections(result);
      </script>

      {% for distance_text, distance_value, start_address, end_address, streets in routes %}
         <p>Route from <b>{{ start_address }}</b> to <b>{{ end_address }}</b><br>
         Distance: {{ distance_text }}</p>
         <ul>
         {% for street, rating in streets%}

            <li>{{ street }} &mdash; {{ rating }}</li>

         {% endfor %}
         </ul>
      {% endfor %}
   </body>
</html>
